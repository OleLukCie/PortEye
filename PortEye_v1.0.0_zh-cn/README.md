# PortEye - 端口监控系统

PortEye 是一个基于 Python Flask 框架开发的端口监控系统，它可以实时监控系统中正在监听的网络端口，并记录端口的开放和关闭历史。该系统通过前后端分离的方式，提供了一个简单易用的 Web 界面，方便用户查看端口信息和历史记录。

## 功能特性
- **实时端口监控**：实时显示系统中正在监听的网络端口信息，包括端口号、进程名、命令行、CPU 使用率和内存使用率。
- **端口历史记录**：记录端口的开放和关闭事件，用户可以查看历史记录，了解端口的使用情况。
- **数据过滤**：支持按端口号和进程名对当前端口信息和历史记录进行过滤，方便用户快速定位所需信息。
- **权限检查**：在运行程序时，会自动检查是否具有管理员权限，确保可以访问系统的网络连接信息。
- **信号处理**：支持 `SIGINT` 和 `SIGTERM` 信号，当程序接收到这些信号时，会停止端口监控线程并退出程序。

## 安装与运行

### 环境要求
- Python 3.x
- Flask
- Flask-CORS
- psutil
- sqlite3

### 安装依赖
```bash
pip install flask flask-cors psutil
```

### 运行程序
```bash
python app.py
```

### 注意事项
- 在 Windows 系统上，程序会自动请求管理员权限；在 Linux 系统上，请使用 `sudo` 运行程序。
- 程序启动后，会自动打开浏览器访问 `http://localhost:5000`。

## 使用方法

### 当前端口信息
- 在“端口过滤”输入框中输入端口号，可筛选出指定端口的信息。
- 在“进程过滤”输入框中输入进程名，可筛选出指定进程占用的端口信息。
- 点击“过滤”按钮，即可显示过滤后的结果。

### 端口历史记录
- 在“显示记录数量”输入框中输入要显示的记录数量。
- 在“端口过滤”输入框中输入端口号，可筛选出指定端口的历史记录。
- 在“进程过滤”输入框中输入进程名，可筛选出指定进程的历史记录。
- 点击“过滤”按钮，即可显示过滤后的结果。

## 项目结构
```
PortEye/
├── app.py              # 后端代码，负责权限检查、数据库初始化、端口监控以及提供 API 接口
├── templates/
│   └── index.html      # 前端页面，通过 JavaScript 与后端 API 交互，展示当前端口信息和端口历史记录
└── port_monitor.db     # SQLite 数据库，用于存储端口的开放和关闭历史记录
```

## API 接口

### 获取当前端口信息
- **URL**：`/api/ports`
- **方法**：`GET`
- **参数**：
  - `port`：可选，端口号，用于过滤指定端口的信息。
  - `process`：可选，进程名，用于过滤指定进程占用的端口信息。
- **返回值**：JSON 数组，包含当前正在监听的端口信息。

### 获取端口历史记录
- **URL**：`/api/history`
- **方法**：`GET`
- **参数**：
  - `limit`：可选，默认值为 100，用于指定要返回的记录数量。
  - `port`：可选，端口号，用于过滤指定端口的历史记录。
  - `process`：可选，进程名，用于过滤指定进程的历史记录。
- **返回值**：JSON 数组，包含端口的历史记录信息。

## 贡献
如果你对该项目感兴趣，可以通过以下方式贡献代码：
1. Fork 该项目。
2. 创建你的特性分支 (`git checkout -b feature/your-feature`)。
3. 提交你的更改 (`git commit -m 'Add some feature'`)。
4. 将你的更改推送到远程分支 (`git push origin feature/your-feature`)。
5. 打开一个 Pull Request。

## 许可证
该项目采用 MIT 许可证，详情请参阅 [LICENSE](LICENSE) 文件。