# PortEye - 端口監控系統

PortEye 是一個基於 Python Flask 框架開發的端口監控系統，它可以即時監控系統中正在監聽的網絡端口，並記錄端口的開放和關閉歷史。該系統透過前後端分離的方式，提供了一個簡單易用的 Web 介面，方便用戶查看端口資訊和歷史記錄。

## 功能特性
- **即時端口監控**：即時顯示系統中正在監聽的網絡端口資訊，包括端口號、進程名、命令列、CPU 使用率和記憶體使用率。
- **端口歷史記錄**：記錄端口的開放和關閉事件，用戶可以查看歷史記錄，了解端口的使用情況。
- **資料過濾**：支援按端口號和進程名對當前端口資訊和歷史記錄進行過濾，方便用戶快速定位所需資訊。
- **權限檢查**：在執行程式時，會自動檢查是否具有管理員權限，確保可以存取系統的網絡連線資訊。
- **信號處理**：支援 `SIGINT` 和 `SIGTERM` 信號，當程式接收到這些信號時，會停止端口監控執行緒並退出程式。

## 安裝與執行

### 環境要求
- Python 3.x
- Flask
- Flask-CORS
- psutil
- sqlite3

### 安裝依賴
```bash
pip install flask flask-cors psutil
```

### 執行程式
```bash
python app.py
```

### 注意事項
- 在 Windows 系統上，程式會自動請求管理員權限；在 Linux 系統上，請使用 `sudo` 執行程式。
- 程式啟動後，會自動打開瀏覽器訪問 `http://localhost:5000`。

## 使用方法

### 當前端口資訊
- 在「端口過濾」輸入框中輸入端口號，可篩選出指定端口的資訊。
- 在「進程過濾」輸入框中輸入進程名，可篩選出指定進程佔用的端口資訊。
- 點擊「過濾」按鈕，即可顯示過濾後的結果。

### 端口歷史記錄
- 在「顯示記錄數量」輸入框中輸入要顯示的記錄數量。
- 在「端口過濾」輸入框中輸入端口號，可篩選出指定端口的歷史記錄。
- 在「進程過濾」輸入框中輸入進程名，可篩選出指定進程的歷史記錄。
- 點擊「過濾」按鈕，即可顯示過濾後的結果。

## 專案結構
```
PortEye/
├── app.py              # 後端程式碼，負責權限檢查、資料庫初始化、端口監控以及提供 API 介面
├── templates/
│   └── index.html      # 前端頁面，透過 JavaScript 與後端 API 互動，展示當前端口資訊和端口歷史記錄
└── port_monitor.db     # SQLite 資料庫，用於儲存端口的開放和關閉歷史記錄
```

## API 介面

### 取得當前端口資訊
- **URL**：`/api/ports`
- **方法**：`GET`
- **參數**：
  - `port`：可選，端口號，用於過濾指定端口的資訊。
  - `process`：可選，進程名，用於過濾指定進程佔用的端口資訊。
- **返回值**：JSON 陣列，包含當前正在監聽的端口資訊。

### 取得端口歷史記錄
- **URL**：`/api/history`
- **方法**：`GET`
- **參數**：
  - `limit`：可選，預設值為 100，用於指定要返回的記錄數量。
  - `port`：可選，端口號，用於過濾指定端口的歷史記錄。
  - `process`：可選，進程名，用於過濾指定進程的歷史記錄。
- **返回值**：JSON 陣列，包含端口的歷史記錄資訊。

## 貢獻
如果你對該專案感興趣，可以透過以下方式貢獻程式碼：
1. Fork 該專案。
2. 建立你的功能分支 (`git checkout -b feature/your-feature`)。
3. 提交你的更改 (`git commit -m 'Add some feature'`)。
4. 將你的更改推送至遠端分支 (`git push origin feature/your-feature`)。
5. 開啟一個 Pull Request。

## 授權
該專案採用 MIT 授權，詳情請參閱 [LICENSE](LICENSE) 檔案。